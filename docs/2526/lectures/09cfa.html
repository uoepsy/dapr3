<!DOCTYPE html>
<html lang="en"><head>
<script src="09cfa_files/libs/clipboard/clipboard.min.js"></script>
<script src="09cfa_files/libs/quarto-html/tabby.min.js"></script>
<script src="09cfa_files/libs/quarto-html/popper.min.js"></script>
<script src="09cfa_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="09cfa_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="09cfa_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="09cfa_files/libs/quarto-html/quarto-syntax-highlighting-ce80fb680f754bdddd2e33f428b7c2fe.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Dr Josiah King">
  <title>Confirmatory Factor Analysis (CFA)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="09cfa_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="09cfa_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="09cfa_files/libs/revealjs/dist/theme/quarto-ee739ae4c1cdd632805215fac81aa502.css">
  <link rel="stylesheet" href="img/css/wizard.css">
  <link href="09cfa_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="09cfa_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="09cfa_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="09cfa_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="09cfa_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="09cfa_files/libs/revealjs/plugin/reveal-attribution/attribution.css" rel="stylesheet">
  <link href="09cfa_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>

  $(document).ready(function() {

      $('.cell').each(function() {

          let highlightLines = $(this).attr('data-output-line-numbers');

          if (highlightLines) {

              let lines = highlightLines.split(',').map(x => parseInt(x));

              $(this).find('.cell-output-stdout pre code').html(function(_, html) {

                  return html.split('\n').map((line, index) => {

                      if (lines.includes(index + 1)) {

                          return '<span style="background-color: #D0D8FC;">' + line + '</span>';

                      } else {

                          return line;

                      }

                  }).join('\n');

              });

          }

      });

  });

  </script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#88B04B" data-background-image="img/logo.svg" data-background-position="2% 2%" data-background-size="25%" class="quarto-title-block center">
  <h1 class="title">Confirmatory Factor Analysis (CFA)</h1>
  <p class="subtitle">Data Analysis for Psychology in R 3</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr Josiah King 
</div>
        <p class="quarto-title-affiliation">
            Psychology, PPLS
          </p>
        <p class="quarto-title-affiliation">
            University of Edinburgh
          </p>
    </div>
</div>

</section>
<section class="slide level2">

<div class="cell">
<style type="text/css">
.output {
max-height: 500px;
overflow-y: scroll;
}
</style>
</div>
</section>
<section>
<section id="course-overview" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Course Overview</h1>
<table style="border: 1px solid black;>
  <tr style=" padding:="" 0="" 1em="" 1em;"="">
    <tbody><tr><td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1;text-align:center;vertical-align: middle">
        <b>multilevel modelling<br>working with group structured data</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        regression refresher</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        the multilevel model</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        more complex groupings</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        centering, assumptions, and diagnostics</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        recap</td></tr>

  <tr style="padding: 0 1em 0 1em;">
    <td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1;text-align:center;vertical-align: middle">
        <b>factor analysis<br>working with multi-item measures</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        measurement and dimensionality</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        exploring underlying constructs (EFA)</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        <b>testing theoretical models (CFA)</b></td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        reliability and validity</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        recap &amp; exam prep</td></tr>
</tbody></table>
</section>
<section id="week-8-trdl" class="slide level2">
<h2>Week 8 TR;DL</h2>
<ul>
<li>PCA just takes a set of observed variables and reduces.
<ul>
<li>we don’t really care what the components are, we don’t have a theory why variables are correlated</li>
</ul></li>
<li>EFA is a <strong>model</strong> of underlying ‘latent variables/factors’ that give rise to responses on observed variables
<ul>
<li>we give a meaning to the underlying factors</li>
</ul></li>
<li>The aim is to explore different models (e.g., 1 factor, 2 factor) to understand what our measurement tool captures</li>
<li>the “best” model here is a combination of
<ul>
<li>variance explained</li>
<li>“simple structure” (clear patterns of loadings)</li>
<li>theoretical coherence</li>
</ul></li>
</ul>
</section></section>
<section id="this-week" class="title-slide slide level1 center" data-transition="slide" data-background-color="#88B04B">
<h1>This week</h1>
<ul>
<li>CFA vs EFA</li>
<li>CFA in R (lavaan)</li>
<li>Model fit</li>
<li>Model modification</li>
<li>the gateway to SEM</li>
</ul>
</section>

<section>
<section id="from-efa-to-cfa" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>from EFA to CFA</h1>

</section>
<section id="what-is-your-quest" class="slide level2">
<h2>What is your quest?</h2>
<ul>
<li><p>I have too many correlated variables. I just need to reduce <strong>→ PCA</strong></p></li>
<li><p>I want to understand the underlying structure of my set of correlated variables <strong>→ EFA</strong></p></li>
<li><p>I have a theoretical structure underlying a set of correlated variables. I want to test it <strong>→ CFA</strong></p></li>
<li><p>I need a way to get a single score for a construct <strong>→ mean scores/sum scores/PCA/EFA/CFA</strong></p></li>
</ul>
</section>
<section id="in-diagrams-efa" class="slide level2">
<h2>In diagrams: EFA</h2>

<img data-src="img_sandbox/diag_efa1.png" class="r-stretch"></section>
<section id="in-diagrams-efa-oblique-rotation" class="slide level2">
<h2>In diagrams: EFA (oblique rotation)</h2>

<img data-src="img_sandbox/diag_efa2.png" class="r-stretch"></section>
<section id="in-diagrams-cfa" class="slide level2">
<h2>In diagrams: CFA</h2>

<img data-src="img_sandbox/diag_cfa.png" class="r-stretch"></section>
<section id="in-diagrams-cfa-1" class="slide level2">
<h2>In diagrams: CFA</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/diag_cfa2.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li>Some arrows are absent</li>
<li>This is what imposes our theory</li>
</ul>
<div class="fragment">
<ul>
<li>The reason that <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> are correlated is because:
<ul>
<li>they both represent <span class="math inline">\(F_1\)</span><br>
</li>
</ul></li>
<li>The reason that <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_6\)</span> are correlated is because:
<ul>
<li><span class="math inline">\(y_1\)</span> is a manifestation of <span class="math inline">\(F_1\)</span>,</li>
<li><span class="math inline">\(y_6\)</span> is a manifestation of <span class="math inline">\(F_2\)</span>,</li>
<li>and <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span> are correlated<br>
</li>
</ul></li>
</ul>
</div>
</div></div>
</section>
<section id="in-diagrams-residuals-in-cfa" class="slide level2">
<h2>In diagrams: residuals in CFA</h2>
<p>different ways people choose to draw the same thing…</p>

<img data-src="img_sandbox/diag_resid.png" class="r-stretch"></section></section>
<section>
<section id="cfa-in-r" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>CFA in R</h1>

</section>
<section id="the-steps-of-cfa" class="slide level2">
<h2>The steps of CFA<sup>1</sup></h2>
<ol type="1">
<li>measures, assumptions, data</li>
<li><strong>specification</strong></li>
<li>identification</li>
<li><strong>estimation</strong></li>
<li>fit</li>
<li>possible respecification <strong>⚠</strong><br>
</li>
<li>interpretation</li>
</ol>
<aside><ol class="aside-footnotes"><li id="fn1"><p>and Structural Equation Modelling (SEM) in general</p></li></ol></aside></section>
<section id="the-lavaan-package" class="slide level2">
<h2>the lavaan package</h2>
<ul>
<li><p>“<strong>la</strong>tent <strong>va</strong>riable <strong>an</strong>alysis”</p></li>
<li><p>general modelling framework that estimates models that may include latent variables</p></li>
</ul>
</section>
<section id="typically-done-in-2-steps" class="slide level2">
<h2>Typically done in 2 steps</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Previously:</p>
<ul>
<li><code>lm(formula, data = mydata)</code></li>
<li><code>glm(formula, data = mydata)</code></li>
<li><code>lmer(formula, data = mydata)</code></li>
</ul>
</div><div class="column" style="width:50%;">
<p>With <strong>{lavaan}</strong>:</p>
<ul>
<li><p>Specify model formula in quotation marks:<br>
<code>mymod &lt;- "................"</code></p></li>
<li><p>Estimate<sup>1</sup> formula with a fitting function such as:<br>
<code>mymod.est &lt;- cfa(mymod, data = mydata)</code></p></li>
</ul>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>estimation is generally good ol’ max likelihood!</p></li></ol></aside></section>
<section id="lavaan-operators" class="slide level2">
<h2>lavaan operators</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Formula type</th>
<th style="text-align: right;">Operator</th>
<th style="text-align: right;">Mnemonic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">latent variable definition</td>
<td style="text-align: right;"><code>=~</code></td>
<td style="text-align: right;">“is measured by”</td>
</tr>
<tr class="even">
<td style="text-align: right;">(residual) (co)variance</td>
<td style="text-align: right;"><code>~~</code></td>
<td style="text-align: right;">“covaries with”</td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/diag_cfa2.png"></p>
</div><div class="column" style="font-size:3em">
<p><br> <br></p>
<pre><code>F1 =~ y1 + y2 + y3
F2 =~ y4 + y5 + y6
F1 ~~ F2</code></pre>
</div></div>
</section>
<section id="example-qri" class="slide level2">
<h2>example: QRI</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/qri_expl.png"></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="dhodzlgiuz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dhodzlgiuz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dhodzlgiuz thead, #dhodzlgiuz tbody, #dhodzlgiuz tfoot, #dhodzlgiuz tr, #dhodzlgiuz td, #dhodzlgiuz th {
  border-style: none;
}

#dhodzlgiuz p {
  margin: 0;
  padding: 0;
}

#dhodzlgiuz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dhodzlgiuz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dhodzlgiuz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dhodzlgiuz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dhodzlgiuz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dhodzlgiuz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dhodzlgiuz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dhodzlgiuz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dhodzlgiuz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dhodzlgiuz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dhodzlgiuz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dhodzlgiuz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dhodzlgiuz .gt_spanner_row {
  border-bottom-style: hidden;
}

#dhodzlgiuz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dhodzlgiuz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dhodzlgiuz .gt_from_md > :first-child {
  margin-top: 0;
}

#dhodzlgiuz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dhodzlgiuz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dhodzlgiuz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dhodzlgiuz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dhodzlgiuz .gt_row_group_first td {
  border-top-width: 2px;
}

#dhodzlgiuz .gt_row_group_first th {
  border-top-width: 2px;
}

#dhodzlgiuz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhodzlgiuz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dhodzlgiuz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dhodzlgiuz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dhodzlgiuz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhodzlgiuz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dhodzlgiuz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dhodzlgiuz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dhodzlgiuz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dhodzlgiuz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dhodzlgiuz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhodzlgiuz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dhodzlgiuz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhodzlgiuz .gt_left {
  text-align: left;
}

#dhodzlgiuz .gt_center {
  text-align: center;
}

#dhodzlgiuz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dhodzlgiuz .gt_font_normal {
  font-weight: normal;
}

#dhodzlgiuz .gt_font_bold {
  font-weight: bold;
}

#dhodzlgiuz .gt_font_italic {
  font-style: italic;
}

#dhodzlgiuz .gt_super {
  font-size: 65%;
}

#dhodzlgiuz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dhodzlgiuz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dhodzlgiuz .gt_indent_1 {
  text-indent: 5px;
}

#dhodzlgiuz .gt_indent_2 {
  text-indent: 10px;
}

#dhodzlgiuz .gt_indent_3 {
  text-indent: 15px;
}

#dhodzlgiuz .gt_indent_4 {
  text-indent: 20px;
}

#dhodzlgiuz .gt_indent_5 {
  text-indent: 25px;
}

#dhodzlgiuz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dhodzlgiuz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="var" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">var</th>
<th id="wording" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">wording</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="var">s1</td>
<td class="gt_row gt_left" headers="wording">To what extent could you turn to this person for advice about problems?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">s2</td>
<td class="gt_row gt_left" headers="wording">To what extent could you count on this person for help with a problem?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">s3</td>
<td class="gt_row gt_left" headers="wording">To what extent can you really count on this person to distract you from your worries when you feel under stress?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">s4</td>
<td class="gt_row gt_left" headers="wording">To what extent can you count on this person to listen to you when you are very angry at someone else?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">c1</td>
<td class="gt_row gt_left" headers="wording">How often do you have to work hard to avoid conflict with this person?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">c2</td>
<td class="gt_row gt_left" headers="wording">How much do you argue with this person?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">c3</td>
<td class="gt_row gt_left" headers="wording">How much would you like this person to change?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">c4</td>
<td class="gt_row gt_left" headers="wording">How often does this person make you feel angry?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">d1</td>
<td class="gt_row gt_left" headers="wording">How positive a role does this person play in your life?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">d2</td>
<td class="gt_row gt_left" headers="wording">How significant is this relationship in your life?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">d3</td>
<td class="gt_row gt_left" headers="wording">How close will your relationship be with this person in 10 years?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">d4</td>
<td class="gt_row gt_left" headers="wording">How much would you miss this person if the two of you could not see or talk with each other for a month?</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div></div>
</section>
<section id="example-qri-1" class="slide level2">
<h2>example: QRI</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/qri_example/Slide1.PNG"></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a>qri <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://uoepsy.github.io/data/qri.csv"</span>)</span>
<span id="cb2-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(qri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  s2 d4 c3 c4 d1 c2 s1 s4 d2 c1 s3 d3
1  4  4  5  5  5  4  3  3  2  3  5  5
2  3  5  4  4  2  4  4  5  2  4  4  4
3  4  5  4  5  4  2  5  3  6  2  4  5
4  3  6  4  3  5  3  3  4  4  2  5  5
5  6  7  1  2  4  2  7  7  4  1  7  5
6  3  5  5  4  4  3  5  4  3  3  5  5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a>mymod <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb4-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">support =~ s1 + s2 + s3 + s4</span></span>
<span id="cb4-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">conflict =~ c1 + c2 + c3 + c4</span></span>
<span id="cb4-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">depth =~ d1 + d2 + d3 + d4</span></span>
<span id="cb4-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">support ~~ conflict</span></span>
<span id="cb4-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">support ~~ depth</span></span>
<span id="cb4-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">conflict ~~ depth</span></span>
<span id="cb4-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb4-10"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="" aria-hidden="true" tabindex="-1"></a>mymod.est <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mymod, <span class="at">data =</span> qri, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="example-qri-2" class="slide level2">
<h2>example: QRI</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/qri_example/Slide2.PNG"></p>
</div><div class="column" style="width:50%;">
<div class="cell output">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymod.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 19 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           374

Model Test User Model:
                                                      
  Test statistic                                81.100
  Degrees of freedom                                51
  P-value (Chi-square)                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support =~                                          
    s1                0.601    0.062    9.765    0.000
    s2                0.707    0.064   11.010    0.000
    s3                0.642    0.074    8.676    0.000
    s4                0.608    0.072    8.407    0.000
  conflict =~                                         
    c1                0.860    0.077   11.102    0.000
    c2                0.810    0.063   12.909    0.000
    c3                0.614    0.072    8.532    0.000
    c4                0.808    0.064   12.673    0.000
  depth =~                                            
    d1                0.617    0.063    9.759    0.000
    d2                0.770    0.069   11.175    0.000
    d3                0.621    0.061   10.119    0.000
    d4                0.634    0.062   10.143    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support ~~                                          
    conflict         -0.530    0.063   -8.473    0.000
    depth             0.613    0.062    9.956    0.000
  conflict ~~                                         
    depth            -0.425    0.065   -6.551    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .s1                0.763    0.070   10.860    0.000
   .s2                0.738    0.077    9.626    0.000
   .s3                1.188    0.102   11.625    0.000
   .s4                1.151    0.098   11.781    0.000
   .c1                1.259    0.116   10.893    0.000
   .c2                0.692    0.076    9.128    0.000
   .c3                1.251    0.102   12.276    0.000
   .c4                0.735    0.078    9.409    0.000
   .d1                0.839    0.075   11.146    0.000
   .d2                0.885    0.089    9.923    0.000
   .d3                0.771    0.071   10.880    0.000
   .d4                0.797    0.073   10.861    0.000
    support           1.000                           
    conflict          1.000                           
    depth             1.000                           </code></pre>
</div>
</div>
</div></div>
</section>
<section id="example-qri-3" class="slide level2">
<h2>example: QRI</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/qri_example/Slide3.PNG"></p>
</div><div class="column" style="width:50%;">
<div class="cell output">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymod.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 19 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           374

Model Test User Model:
                                                      
  Test statistic                                81.100
  Degrees of freedom                                51
  P-value (Chi-square)                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support =~                                          
    s1                0.601    0.062    9.765    0.000
    s2                0.707    0.064   11.010    0.000
    s3                0.642    0.074    8.676    0.000
    s4                0.608    0.072    8.407    0.000
  conflict =~                                         
    c1                0.860    0.077   11.102    0.000
    c2                0.810    0.063   12.909    0.000
    c3                0.614    0.072    8.532    0.000
    c4                0.808    0.064   12.673    0.000
  depth =~                                            
    d1                0.617    0.063    9.759    0.000
    d2                0.770    0.069   11.175    0.000
    d3                0.621    0.061   10.119    0.000
    d4                0.634    0.062   10.143    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support ~~                                          
    conflict         -0.530    0.063   -8.473    0.000
    depth             0.613    0.062    9.956    0.000
  conflict ~~                                         
    depth            -0.425    0.065   -6.551    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .s1                0.763    0.070   10.860    0.000
   .s2                0.738    0.077    9.626    0.000
   .s3                1.188    0.102   11.625    0.000
   .s4                1.151    0.098   11.781    0.000
   .c1                1.259    0.116   10.893    0.000
   .c2                0.692    0.076    9.128    0.000
   .c3                1.251    0.102   12.276    0.000
   .c4                0.735    0.078    9.409    0.000
   .d1                0.839    0.075   11.146    0.000
   .d2                0.885    0.089    9.923    0.000
   .d3                0.771    0.071   10.880    0.000
   .d4                0.797    0.073   10.861    0.000
    support           1.000                           
    conflict          1.000                           
    depth             1.000                           </code></pre>
</div>
</div>
</div></div>
</section>
<section id="latent-variable-scaling" class="slide level2">
<h2>latent variable scaling</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>the latent factor is unobserved</p></li>
<li><p>its scale doesn’t exist - we need to fix it to something.</p></li>
</ul>
<p>We can…</p>
<p><strong>fix its variance to 1 (as previous slides).</strong></p>
</div><div class="column" style="width:50%;">
<p><code>std.lv = TRUE</code> &gt;&gt; latent variables are standardised</p>
<div class="cell output">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a>mymod.est <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mymod, <span class="at">data =</span> qri, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymod.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 19 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           374

Model Test User Model:
                                                      
  Test statistic                                81.100
  Degrees of freedom                                51
  P-value (Chi-square)                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support =~                                          
    s1                0.601    0.062    9.765    0.000
    s2                0.707    0.064   11.010    0.000
    s3                0.642    0.074    8.676    0.000
    s4                0.608    0.072    8.407    0.000
  conflict =~                                         
    c1                0.860    0.077   11.102    0.000
    c2                0.810    0.063   12.909    0.000
    c3                0.614    0.072    8.532    0.000
    c4                0.808    0.064   12.673    0.000
  depth =~                                            
    d1                0.617    0.063    9.759    0.000
    d2                0.770    0.069   11.175    0.000
    d3                0.621    0.061   10.119    0.000
    d4                0.634    0.062   10.143    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support ~~                                          
    conflict         -0.530    0.063   -8.473    0.000
    depth             0.613    0.062    9.956    0.000
  conflict ~~                                         
    depth            -0.425    0.065   -6.551    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .s1                0.763    0.070   10.860    0.000
   .s2                0.738    0.077    9.626    0.000
   .s3                1.188    0.102   11.625    0.000
   .s4                1.151    0.098   11.781    0.000
   .c1                1.259    0.116   10.893    0.000
   .c2                0.692    0.076    9.128    0.000
   .c3                1.251    0.102   12.276    0.000
   .c4                0.735    0.078    9.409    0.000
   .d1                0.839    0.075   11.146    0.000
   .d2                0.885    0.089    9.923    0.000
   .d3                0.771    0.071   10.880    0.000
   .d4                0.797    0.073   10.861    0.000
    support           1.000                           
    conflict          1.000                           
    depth             1.000                           </code></pre>
</div>
</div>
</div></div>
</section>
<section id="latent-variable-scaling-marker-method" class="slide level2">
<h2>latent variable scaling (marker method)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>the latent factor is unobserved</p></li>
<li><p>its scale doesn’t exist - we need to fix it to something.</p></li>
</ul>
<p>We can…</p>
<p><strong>fix it to having the same scale as one of the items (defaults to the first one).</strong></p>
</div><div class="column" style="width:50%;">
<p>the default in lavaan</p>
<div class="cell output">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>mymod.est <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mymod, <span class="at">data =</span> qri)</span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymod.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           374

Model Test User Model:
                                                      
  Test statistic                                81.100
  Degrees of freedom                                51
  P-value (Chi-square)                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support =~                                          
    s1                1.000                           
    s2                1.177    0.155    7.588    0.000
    s3                1.070    0.158    6.759    0.000
    s4                1.013    0.153    6.633    0.000
  conflict =~                                         
    c1                1.000                           
    c2                0.942    0.104    9.025    0.000
    c3                0.714    0.100    7.150    0.000
    c4                0.940    0.105    8.972    0.000
  depth =~                                            
    d1                1.000                           
    d2                1.247    0.162    7.702    0.000
    d3                1.007    0.137    7.374    0.000
    d4                1.027    0.139    7.383    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support ~~                                          
    conflict         -0.274    0.052   -5.293    0.000
    depth             0.227    0.042    5.450    0.000
  conflict ~~                                         
    depth            -0.226    0.048   -4.678    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .s1                0.763    0.070   10.860    0.000
   .s2                0.738    0.077    9.626    0.000
   .s3                1.188    0.102   11.625    0.000
   .s4                1.151    0.098   11.781    0.000
   .c1                1.259    0.116   10.893    0.000
   .c2                0.692    0.076    9.128    0.000
   .c3                1.251    0.102   12.276    0.000
   .c4                0.735    0.078    9.409    0.000
   .d1                0.839    0.075   11.146    0.000
   .d2                0.885    0.089    9.923    0.000
   .d3                0.771    0.071   10.880    0.000
   .d4                0.797    0.073   10.861    0.000
    support           0.361    0.074    4.883    0.000
    conflict          0.740    0.133    5.551    0.000
    depth             0.381    0.078    4.880    0.000</code></pre>
</div>
</div>
</div></div>
</section>
<section id="latent-variable-scaling-its-all-the-same" class="slide level2">
<h2>latent variable scaling (its all the same)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a>mymod.est <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mymod, <span class="at">data =</span> qri)</span>
<span id="cb13-2"><a href="" aria-hidden="true" tabindex="-1"></a>mymod.est1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mymod, <span class="at">data =</span> qri, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(mymod.est, mymod.est1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

           Df   AIC   BIC Chisq Chisq diff RMSEA Df diff Pr(&gt;Chisq)
mymod.est  51 13489 13595  81.1                                    
mymod.est1 51 13489 13595  81.1  -1.02e-09     0       0           </code></pre>
</div>
</div>
</section>
<section id="standardisation" class="slide level2">
<h2>standardisation</h2>
<ul>
<li>Back with EFA, we were working with correlations
<ul>
<li>everything was already standardised<br>
</li>
</ul></li>
<li>Now we are working with covariances
<ul>
<li>model parameters depend on the scales of the variables</li>
</ul></li>
</ul>
</section>
<section id="standardisation-1" class="slide level2">
<h2>standardisation</h2>
<ul>
<li><code>Std.lv</code> column = latent variables are standardised, observed variables aren’t<br>
</li>
<li><code>Std.all</code> column = both latent variables and observed variables are standardised</li>
</ul>
<div class="cell output">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a>mymod.est <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mymod, <span class="at">data =</span> qri)</span>
<span id="cb15-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymod.est, <span class="at">std =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           374

Model Test User Model:
                                                      
  Test statistic                                81.100
  Degrees of freedom                                51
  P-value (Chi-square)                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  support =~                                                            
    s1                1.000                               0.601    0.567
    s2                1.177    0.155    7.588    0.000    0.707    0.636
    s3                1.070    0.158    6.759    0.000    0.642    0.508
    s4                1.013    0.153    6.633    0.000    0.608    0.493
  conflict =~                                                           
    c1                1.000                               0.860    0.608
    c2                0.942    0.104    9.025    0.000    0.810    0.698
    c3                0.714    0.100    7.150    0.000    0.614    0.481
    c4                0.940    0.105    8.972    0.000    0.808    0.686
  depth =~                                                              
    d1                1.000                               0.617    0.559
    d2                1.247    0.162    7.702    0.000    0.770    0.633
    d3                1.007    0.137    7.374    0.000    0.621    0.578
    d4                1.027    0.139    7.383    0.000    0.634    0.579

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  support ~~                                                            
    conflict         -0.274    0.052   -5.293    0.000   -0.530   -0.530
    depth             0.227    0.042    5.450    0.000    0.613    0.613
  conflict ~~                                                           
    depth            -0.226    0.048   -4.678    0.000   -0.425   -0.425

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .s1                0.763    0.070   10.860    0.000    0.763    0.679
   .s2                0.738    0.077    9.626    0.000    0.738    0.596
   .s3                1.188    0.102   11.625    0.000    1.188    0.742
   .s4                1.151    0.098   11.781    0.000    1.151    0.757
   .c1                1.259    0.116   10.893    0.000    1.259    0.630
   .c2                0.692    0.076    9.128    0.000    0.692    0.513
   .c3                1.251    0.102   12.276    0.000    1.251    0.768
   .c4                0.735    0.078    9.409    0.000    0.735    0.529
   .d1                0.839    0.075   11.146    0.000    0.839    0.688
   .d2                0.885    0.089    9.923    0.000    0.885    0.599
   .d3                0.771    0.071   10.880    0.000    0.771    0.666
   .d4                0.797    0.073   10.861    0.000    0.797    0.665
    support           0.361    0.074    4.883    0.000    1.000    1.000
    conflict          0.740    0.133    5.551    0.000    1.000    1.000
    depth             0.381    0.078    4.880    0.000    1.000    1.000</code></pre>
</div>
</div>
</section></section>
<section>
<section id="model-fit-idenfication" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>model fit &amp; idenfication</h1>

</section>
<section id="the-steps-of-cfa-1" class="slide level2">
<h2>The steps of CFA<sup>1</sup></h2>
<ol type="1">
<li>measures, assumptions, data</li>
<li><em>specification ✓</em></li>
<li><strong>identification</strong></li>
<li><em>estimation ✓</em></li>
<li><strong>fit</strong></li>
<li>possible respecification <strong>⚠</strong><br>
</li>
<li>interpretation</li>
</ol>
<aside><ol class="aside-footnotes"><li id="fn3"><p>and Structural Equation Modelling (SEM) in general</p></li></ol></aside></section>
<section id="what-is-model-fit" class="slide level2">
<h2>what is model fit?</h2>
<p><strong>“how well does my model reproduce my outcome?”</strong></p>
</section>
<section id="previous-models-lm-lmer" class="slide level2">
<h2>Previous models (lm, lmer):</h2>
<ul>
<li>outcome = a single variable</li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{outcome} &amp;= \text{model} &amp;+ \text{error} \\
\quad \\
\text{observed variable} &amp; = \text{coefficients and predictor variables} &amp;+ \text{error} \\
\quad \\
\text{observed variable} &amp; = \text{model predicted values} &amp;+ \text{error} \\
\end{align}
\]</span></p>
<!-- ## Previous models (lm, lmer) (2) -->
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- Our model $\hat{\textrm{f}}\textrm{itted}$ to some data:   -->
<!-- $\color{red}{y_i} = \color{blue}{5 \cdot{} 1 + 2 \cdot{} x_i} + \hat\varepsilon_i$   -->
<!-- For the observation where $x = 1.2$ and $y = 9.9$:   -->
<!--   - $\color{red}{9.9}$ is the value we observe when $x=1.2$    -->
<!--   - $(\color{blue}{5 \cdot{}} 1 + \color{blue}{2 \cdot{}} 1.2) = 7.4$ is the value the model _predicts_ when $x=1.2$    -->
<!--   - $\color{red}{9.9} = 7.4 + 2.5$   -->
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<!-- ```{r} -->
<!-- #| label: errplot -->
<!-- x <- tibble(x=c(-1,4)) -->
<!-- f <- function(x) {5+2*x} -->
<!-- p1 <- x |> ggplot(aes(x=x)) + -->
<!--   stat_function(fun=f,size=1,colour="blue") + -->
<!--   geom_segment(aes(x=0,xend=0,y=0,yend=f(0)),colour="blue", lty="dotted") + -->
<!--   geom_segment(aes(x=0,xend=1,y=f(0),yend=f(0)),colour="blue",linetype="dotted") + -->
<!--   geom_segment(aes(x=1,y=f(0),xend=1,yend=f(1)),colour="blue",linetype="dotted") + -->
<!--   geom_point(x=0,y=f(0),col="blue",size=3)+ -->
<!--   annotate("text",x=0.5,y=3,hjust=0,label=expression(paste(b[0], " (intercept)")), -->
<!--            size=8,parse=TRUE,colour="blue") + -->
<!--   geom_segment(x=.5,xend=0.01,y=3,yend=4.9,arrow = arrow(length=unit(0.30,"cm")),col="blue")+ -->
<!--   geom_segment(x=1.02,xend=1.02,y=5,yend=7,col="blue")+ -->
<!--   geom_segment(x=c(1,1),xend=c(1.02,1.02),y=c(5,7),yend=c(5,7),col="blue")+ -->
<!--   annotate("text",x=1,y=6,hjust=-.1,label=expression(paste(b[1], " (slope)")), -->
<!--            size=8,parse=TRUE,colour="blue") + -->
<!--     ggtitle(expression(paste(b[0]," = 5, ",b[1]," = 2")))+ -->
<!--   scale_y_continuous(breaks=0:13)+ -->
<!--   scale_x_continuous(limits = c(-0.3, 4), breaks=0:4) -->
<!-- xX <-1.2 -->
<!-- yY <- 9.9 -->
<!-- p1 + #ylab(expression(paste(hat(y)," = ",5 %.% 1 + 2 %.% x))) + -->
<!--   geom_point(aes(x=xX,y=yY),size=3,colour="red") + -->
<!--   geom_segment(aes(x=xX,xend=xX,y=f(xX),yend=yY),linetype="dotted",colour="black") + -->
<!--   annotate("text",1.1,8.6,hjust=1,label=expression(paste(epsilon[i]," (residual)")),colour="black",size=8)+ -->
<!--   ggtitle(expression(paste("y = ", 5 %.% 1 + 2 %.% x))) -->
<!-- ``` -->
<!-- ::: -->
<!-- :::: -->
<!-- ## Previous models (lm, lmer) (3) -->
<!-- Measures of "model fit":   -->
<!-- - $R^2$ - proportion of variance in an outcome that is explained by predictors -->
<!-- - reduction in residual SS (leading to an $F$ statistic - i.e., `anova(mod1, mod2)`)  -->
</section>
<section id="cfa" class="slide level2">
<h2>CFA<sup>1</sup></h2>
<ul>
<li>outcome = a covariance matrix</li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{outcome} &amp;= \text{model} &amp;+ \text{error} \\
\quad \\
\text{observed covariance matrix} &amp; = \text{model parameters} &amp;+ \text{error} \\
\quad \\
\text{observed covariance matrix} &amp; = \text{model implied covariance matrix} &amp;+ \text{error} \\
\end{align}
\]</span></p>
<aside><ol class="aside-footnotes"><li id="fn4"><p>and SEM</p></li></ol></aside></section>
<section id="what-are-the-model-parameters" class="slide level2">
<h2>what are the model parameters?</h2>
<p>the estimated paths on the diagram!</p>

<img data-src="img_sandbox/qri_example/Slide3.PNG" class="r-stretch"></section>
<section id="how-does-a-diagram-imply-a-covariance" class="slide level2">
<h2>how does a diagram imply a covariance?</h2>

<img data-src="img_sandbox/intropathtrace/Slide1.png" class="r-stretch"></section>
<section id="how-does-a-diagram-imply-a-covariance-2" class="slide level2">
<h2>how does a diagram imply a covariance? (2)</h2>

<img data-src="img_sandbox/intropathtrace/Slide2.png" class="r-stretch"></section>
<section id="how-does-a-diagram-imply-a-covariance-3" class="slide level2">
<h2>how does a diagram imply a covariance? (3)</h2>

<img data-src="img_sandbox/intropathtrace/Slide3.png" class="r-stretch"></section>
<section id="identifiability" class="slide level2">
<h2>identifiability</h2>

<img data-src="img_sandbox/intropathtrace/Slide4.png" class="r-stretch"></section>
<section id="identifiability-2" class="slide level2">
<h2>identifiability (2)</h2>

<img data-src="img_sandbox/intropathtrace/Slide5.png" class="r-stretch"></section>
<section id="identifiability-3" class="slide level2">
<h2>identifiability (3)</h2>

<img data-src="img_sandbox/intropathtrace/Slide6.png" class="r-stretch"></section>
<section id="identifiability-4" class="slide level2">
<h2>identifiability (4)</h2>
<p>Conceptually:</p>
<ul>
<li>Back in linear regression world - with just two datapoints there is only one line we can draw.
<ul>
<li>we start with 2 datapoints, and we estimate 2 things (intercept and slope).<br>
<br></li>
</ul></li>
<li>In CFA world, the same applies for a factor with 3 ‘indicators’ (items)
<ul>
<li>we start with 6 values, and we estimate 6 things</li>
</ul></li>
</ul>
<p><br></p>
<p>To measure ‘model fit’ we need to observe more things than we estimate</p>
</section>
<section id="degrees-of-freedom" class="slide level2">
<h2>degrees of freedom</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="how-many-knowns">how many “knowns”?</h3>
<ul>
<li><p>how many values in our covariance matrix?</p></li>
<li><p>for <span class="math inline">\(k\)</span> variables this is <span class="math inline">\(\frac{k(k+1)}{2}\)</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="how-many-unknowns">how many “unknowns”?</h3>
<ul>
<li>how many parameters are we estimating with our model?</li>
</ul>
</div></div>
<p><br><br></p>
<div class="center-x">
<p>degrees of freedom = knowns - unknowns</p>
</div>
</section>
<section id="example-qri-4" class="slide level2">
<h2>example: QRI</h2>
<div class="columns">
<div class="column" style="font-size:.7em">
<h3 id="how-many-knowns-1">how many “knowns”?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(qri) <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      s2    d4    c3    c4    d1    c2    s1    s4    d2    c1    s3    d3
s2  1.00  0.26 -0.19 -0.18  0.18 -0.16  0.39  0.28  0.29 -0.29  0.31  0.26
d4  0.26  1.00 -0.13 -0.08  0.32 -0.16  0.17  0.21  0.35 -0.26  0.17  0.35
c3 -0.19 -0.13  1.00  0.27 -0.17  0.29 -0.23 -0.20 -0.22  0.38 -0.15 -0.21
c4 -0.18 -0.08  0.27  1.00 -0.11  0.57 -0.19 -0.17 -0.11  0.37 -0.20 -0.11
d1  0.18  0.32 -0.17 -0.11  1.00 -0.17  0.16  0.12  0.38 -0.27  0.17  0.32
c2 -0.16 -0.16  0.29  0.57 -0.17  1.00 -0.15 -0.13 -0.12  0.38 -0.18 -0.16
s1  0.39  0.17 -0.23 -0.19  0.16 -0.15  1.00  0.28  0.21 -0.26  0.28  0.17
s4  0.28  0.21 -0.20 -0.17  0.12 -0.13  0.28  1.00  0.20 -0.26  0.29  0.18
d2  0.29  0.35 -0.22 -0.11  0.38 -0.12  0.21  0.20  1.00 -0.22  0.21  0.35
c1 -0.29 -0.26  0.38  0.37 -0.27  0.38 -0.26 -0.26 -0.22  1.00 -0.17 -0.21
s3  0.31  0.17 -0.15 -0.20  0.17 -0.18  0.28  0.29  0.21 -0.17  1.00  0.17
d3  0.26  0.35 -0.21 -0.11  0.32 -0.16  0.17  0.18  0.35 -0.21  0.17  1.00</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<h3 id="how-many-unknowns-1">how many “unknowns”?</h3>
<p><img data-src="img_sandbox/qri_example/Slide3.png"></p>
</div></div>
</section>
<section id="example-qri-5" class="slide level2">
<h2>example: QRI</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="how-many-knowns-2">how many “knowns”?</h3>
<p><strong>78</strong> variances and covariances</p>
<ul>
<li>12 observed variables</li>
<li>(12 x 13) / 2 = 78</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="how-many-unknowns-2">how many “unknowns”?</h3>
<p><strong>27</strong> estimated parameters</p>
<ul>
<li>12 factor loadings</li>
<li>12 residual variances</li>
<li>3 factor correlations</li>
<li><del>3 factor variances</del> (fixed to 1)</li>
</ul>
</div></div>
<div class="cell output">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymod.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           374

Model Test User Model:
                                                      
  Test statistic                                81.100
  Degrees of freedom                                51
  P-value (Chi-square)                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support =~                                          
    s1                1.000                           
    s2                1.177    0.155    7.588    0.000
    s3                1.070    0.158    6.759    0.000
    s4                1.013    0.153    6.633    0.000
  conflict =~                                         
    c1                1.000                           
    c2                0.942    0.104    9.025    0.000
    c3                0.714    0.100    7.150    0.000
    c4                0.940    0.105    8.972    0.000
  depth =~                                            
    d1                1.000                           
    d2                1.247    0.162    7.702    0.000
    d3                1.007    0.137    7.374    0.000
    d4                1.027    0.139    7.383    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  support ~~                                          
    conflict         -0.274    0.052   -5.293    0.000
    depth             0.227    0.042    5.450    0.000
  conflict ~~                                         
    depth            -0.226    0.048   -4.678    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .s1                0.763    0.070   10.860    0.000
   .s2                0.738    0.077    9.626    0.000
   .s3                1.188    0.102   11.625    0.000
   .s4                1.151    0.098   11.781    0.000
   .c1                1.259    0.116   10.893    0.000
   .c2                0.692    0.076    9.128    0.000
   .c3                1.251    0.102   12.276    0.000
   .c4                0.735    0.078    9.409    0.000
   .d1                0.839    0.075   11.146    0.000
   .d2                0.885    0.089    9.923    0.000
   .d3                0.771    0.071   10.880    0.000
   .d4                0.797    0.073   10.861    0.000
    support           0.361    0.074    4.883    0.000
    conflict          0.740    0.133    5.551    0.000
    depth             0.381    0.078    4.880    0.000</code></pre>
</div>
</div>
</section>
<section id="model-fit" class="slide level2">
<h2>model fit</h2>
<p>Pretty much all based on:<br>
<span class="math display">\[
\begin{align}
\text{observed covariance matrix}\,\,\, vs \,\,\, \text{model implied covariance matrix}\\
\end{align}
\]</span></p>
<p>typically also incorporate degrees of freedom (these represent model complexity/parsimony)</p>
</section>
<section id="fit-indices" class="slide level2">
<h2>fit indices</h2>
<p>there are loooooooaddds of different metrics…</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>“absolute fit”</strong></p>
<p>“how far from perfect fit?”</p>
<p>smaller is better</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>fit index</th>
<th>common threshold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RMSEA</td>
<td>&lt;0.05</td>
</tr>
<tr class="even">
<td>SRMR</td>
<td>&lt;0.05/&lt;0.08</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<p><strong>“incremental fit”</strong></p>
<p>“how much better than a null model<sup>1</sup>?”</p>
<p>bigger is better</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>fit index</th>
<th>common threshold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TLI</td>
<td>&gt;0.95</td>
</tr>
<tr class="even">
<td>CFI</td>
<td>&gt;0.95</td>
</tr>
</tbody>
</table>
</div></div>
<p><br><br></p>
<div class="myblock">
<p><strong>In R:</strong></p>
<p><code>fitmeasures(mymod.est)[c("rmsea","srmr","cfi","tli")]</code></p>
<pre><code> rmsea   srmr    cfi    tli 
0.0397 0.0467 0.9619 0.9508 </code></pre>
</div>
<aside><ol class="aside-footnotes"><li id="fn5"><p>the ‘null model’ here is one that has no paths between variables</p></li></ol></aside></section>
<section id="the-steps-of-cfa-2" class="slide level2">
<h2>The steps of CFA<sup>1</sup></h2>
<ol type="1">
<li>measures, assumptions, data</li>
<li><em>specification ✓</em></li>
<li><em>identification ✓</em></li>
<li><em>estimation ✓</em></li>
<li><em>fit ✓</em></li>
<li><strong>possible respecification ⚠</strong><br>
</li>
<li>interpretation</li>
</ol>
<aside><ol class="aside-footnotes"><li id="fn6"><p>and Structural Equation Modelling (SEM) in general</p></li></ol></aside></section></section>
<section>
<section id="model-respecification" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>model respecification</h1>

</section>
<section id="modification-indices" class="slide level2">
<h2>modification indices</h2>
<p>“how much better would my model fit if we included parameter x?”<br>
<br> but..</p>
<ul>
<li>adding in parameters will <em>always</em> improve model fit<br>
</li>
<li>and we lose degrees of freedom
<ul>
<li><span style="color: red;">⬆</span>model complexity, <span style="color: red;">⬇</span> model simplicity</li>
</ul></li>
<li>these should be theoretically justified</li>
</ul>
</section>
<section id="modindices" class="slide level2">
<h2>modindices()</h2>
<ul>
<li><code>lhs</code>, <code>op</code>, <code>rhs</code> = the parameter</li>
<li><code>mi</code> = change in fit</li>
<li><code>epc</code>, <code>sepc.lv</code>, <code>sepc.all</code>, <code>sepc.nox</code> = expected value of parameter (under various forms of standardisation)</li>
</ul>
<div class="cell output">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(mymod.est, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         lhs op rhs     mi    epc sepc.lv sepc.all sepc.nox
101       c2 ~~  c4 50.316  0.561   0.561    0.787    0.787
51     depth =~  c1 15.882 -0.612  -0.378   -0.267   -0.267
31   support =~  c1 14.774 -0.695  -0.417   -0.295   -0.295
54     depth =~  c4 12.504  0.457   0.282    0.239    0.239
32   support =~  c2  9.875  0.478   0.287    0.247    0.247
94        c1 ~~  c3  8.577  0.237   0.237    0.189    0.189
93        c1 ~~  c2  8.101 -0.241  -0.241   -0.258   -0.258
95        c1 ~~  c4  7.628 -0.234  -0.234   -0.243   -0.243
53     depth =~  c3  6.143 -0.351  -0.216   -0.170   -0.170
106       c3 ~~  c4  6.027 -0.170  -0.170   -0.177   -0.177
33   support =~  c3  5.216 -0.378  -0.227   -0.178   -0.178
100       c2 ~~  c3  3.797 -0.134  -0.134   -0.144   -0.144
34   support =~  c4  3.637  0.293   0.176    0.149    0.149
96        c1 ~~  d1  3.523 -0.116  -0.116   -0.113   -0.113
99        c1 ~~  d4  3.320 -0.111  -0.111   -0.111   -0.111
114       c4 ~~  d4  3.179  0.087   0.087    0.114    0.114
52     depth =~  c2  2.985  0.221   0.136    0.117    0.117
68        s2 ~~  c1  2.819 -0.103  -0.103   -0.107   -0.107
108       c3 ~~  d2  2.611 -0.102  -0.102   -0.097   -0.097
85        s4 ~~  c1  2.474 -0.112  -0.112   -0.093   -0.093
103       c2 ~~  d2  2.117  0.076   0.076    0.097    0.097
59        s1 ~~  c2  2.114  0.069   0.069    0.095    0.095
60        s1 ~~  c3  1.940 -0.079  -0.079   -0.081   -0.081
86        s4 ~~  c2  1.895  0.078   0.078    0.087    0.087
77        s3 ~~  c1  1.835  0.099   0.099    0.081    0.081
109       c3 ~~  d3  1.748 -0.076  -0.076   -0.077   -0.077
67        s2 ~~  s4  1.658 -0.089  -0.089   -0.096   -0.096
69        s2 ~~  c2  1.603  0.062   0.062    0.086    0.086
89        s4 ~~  d1  1.592 -0.073  -0.073   -0.074   -0.074
55        s1 ~~  s2  1.525  0.078   0.078    0.103    0.103
35   support =~  d1  1.494 -0.212  -0.127   -0.115   -0.115
72        s2 ~~  d1  1.414 -0.060  -0.060   -0.076   -0.076
47     depth =~  s1  1.403 -0.198  -0.122   -0.115   -0.115
48     depth =~  s2  1.326  0.212   0.131    0.117    0.117
87        s4 ~~  c3  1.326 -0.078  -0.078   -0.065   -0.065
76        s3 ~~  s4  1.244  0.083   0.083    0.071    0.071
92        s4 ~~  d4  1.145  0.061   0.061    0.064    0.064
115       d1 ~~  d2  0.991  0.067   0.067    0.078    0.078
80        s3 ~~  c4  0.971 -0.058  -0.058   -0.062   -0.062
111       c4 ~~  d1  0.853  0.046   0.046    0.059    0.059
73        s2 ~~  d2  0.779  0.048   0.048    0.059    0.059
75        s2 ~~  d4  0.743  0.043   0.043    0.056    0.056
110       c3 ~~  d4  0.682  0.048   0.048    0.048    0.048
65        s1 ~~  d4  0.678 -0.039  -0.039   -0.051   -0.051
44  conflict =~  d2  0.667  0.080   0.069    0.057    0.057
58        s1 ~~  c1  0.660 -0.049  -0.049   -0.050   -0.050
71        s2 ~~  c4  0.616  0.039   0.039    0.053    0.053
113       c4 ~~  d3  0.574  0.036   0.036    0.048    0.048
43  conflict =~  d1  0.558 -0.065  -0.056   -0.051   -0.051
74        s2 ~~  d3  0.541  0.036   0.036    0.047    0.047
40  conflict =~  s2  0.521  0.078   0.067    0.060    0.060
112       c4 ~~  d2  0.493  0.037   0.037    0.046    0.046
64        s1 ~~  d3  0.371 -0.029  -0.029   -0.037   -0.037
78        s3 ~~  c2  0.370 -0.035  -0.035   -0.039   -0.039
118       d2 ~~  d3  0.360 -0.040  -0.040   -0.048   -0.048
119       d2 ~~  d4  0.340 -0.039  -0.039   -0.047   -0.047
102       c2 ~~  d1  0.304 -0.027  -0.027   -0.035   -0.035
36   support =~  d2  0.304  0.109   0.065    0.054    0.054
42  conflict =~  s4  0.285 -0.060  -0.052   -0.042   -0.042
66        s2 ~~  s3  0.263 -0.037  -0.037   -0.039   -0.039
120       d3 ~~  d4  0.259  0.029   0.029    0.037    0.037
56        s1 ~~  s3  0.190 -0.028  -0.028   -0.030   -0.030
84        s3 ~~  d4  0.175 -0.024  -0.024   -0.025   -0.025
38   support =~  d4  0.173  0.072   0.043    0.039    0.039
105       c2 ~~  d4  0.166 -0.020  -0.020   -0.026   -0.026
83        s3 ~~  d3  0.158 -0.023  -0.023   -0.024   -0.024
79        s3 ~~  c3  0.152  0.027   0.027    0.022    0.022
81        s3 ~~  d1  0.147  0.023   0.023    0.023    0.023
45  conflict =~  d3  0.104 -0.028  -0.024   -0.022   -0.022
70        s2 ~~  c3  0.085  0.017   0.017    0.018    0.018
104       c2 ~~  d3  0.074 -0.013  -0.013   -0.018   -0.018
82        s3 ~~  d2  0.042  0.013   0.013    0.013    0.013
91        s4 ~~  d3  0.040  0.011   0.011    0.012    0.012
61        s1 ~~  c4  0.039 -0.010  -0.010   -0.013   -0.013
37   support =~  d3  0.034  0.031   0.019    0.017    0.017
117       d1 ~~  d4  0.033 -0.011  -0.011   -0.013   -0.013
62        s1 ~~  d1  0.031 -0.009  -0.009   -0.011   -0.011
41  conflict =~  s3  0.030 -0.020  -0.017   -0.014   -0.014
46  conflict =~  d4  0.027  0.014   0.012    0.011    0.011
39  conflict =~  s1  0.023 -0.015  -0.013   -0.012   -0.012
49     depth =~  s3  0.021 -0.028  -0.017   -0.014   -0.014
88        s4 ~~  c4  0.019  0.008   0.008    0.009    0.009
63        s1 ~~  d2  0.017  0.007   0.007    0.008    0.008
116       d1 ~~  d3  0.014 -0.007  -0.007   -0.008   -0.008
107       c3 ~~  d1  0.011 -0.006  -0.006   -0.006   -0.006
50     depth =~  s4  0.009  0.018   0.011    0.009    0.009
98        c1 ~~  d3  0.005  0.004   0.004    0.004    0.004
97        c1 ~~  d2  0.004 -0.004  -0.004   -0.004   -0.004
57        s1 ~~  s4  0.003 -0.003  -0.003   -0.004   -0.004
90        s4 ~~  d2  0.002 -0.003  -0.003   -0.003   -0.003</code></pre>
</div>
</div>
</section>
<section id="modification-indices-1" class="slide level2">
<h2>modification indices</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/qri_example/Slide4.png"></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="qwckgwvsfo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qwckgwvsfo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qwckgwvsfo thead, #qwckgwvsfo tbody, #qwckgwvsfo tfoot, #qwckgwvsfo tr, #qwckgwvsfo td, #qwckgwvsfo th {
  border-style: none;
}

#qwckgwvsfo p {
  margin: 0;
  padding: 0;
}

#qwckgwvsfo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qwckgwvsfo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qwckgwvsfo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qwckgwvsfo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qwckgwvsfo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qwckgwvsfo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qwckgwvsfo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qwckgwvsfo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qwckgwvsfo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qwckgwvsfo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qwckgwvsfo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qwckgwvsfo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qwckgwvsfo .gt_spanner_row {
  border-bottom-style: hidden;
}

#qwckgwvsfo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qwckgwvsfo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qwckgwvsfo .gt_from_md > :first-child {
  margin-top: 0;
}

#qwckgwvsfo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qwckgwvsfo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qwckgwvsfo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qwckgwvsfo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qwckgwvsfo .gt_row_group_first td {
  border-top-width: 2px;
}

#qwckgwvsfo .gt_row_group_first th {
  border-top-width: 2px;
}

#qwckgwvsfo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwckgwvsfo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qwckgwvsfo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qwckgwvsfo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qwckgwvsfo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwckgwvsfo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qwckgwvsfo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qwckgwvsfo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qwckgwvsfo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qwckgwvsfo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qwckgwvsfo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwckgwvsfo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qwckgwvsfo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwckgwvsfo .gt_left {
  text-align: left;
}

#qwckgwvsfo .gt_center {
  text-align: center;
}

#qwckgwvsfo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qwckgwvsfo .gt_font_normal {
  font-weight: normal;
}

#qwckgwvsfo .gt_font_bold {
  font-weight: bold;
}

#qwckgwvsfo .gt_font_italic {
  font-style: italic;
}

#qwckgwvsfo .gt_super {
  font-size: 65%;
}

#qwckgwvsfo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qwckgwvsfo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qwckgwvsfo .gt_indent_1 {
  text-indent: 5px;
}

#qwckgwvsfo .gt_indent_2 {
  text-indent: 10px;
}

#qwckgwvsfo .gt_indent_3 {
  text-indent: 15px;
}

#qwckgwvsfo .gt_indent_4 {
  text-indent: 20px;
}

#qwckgwvsfo .gt_indent_5 {
  text-indent: 25px;
}

#qwckgwvsfo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qwckgwvsfo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="var" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">var</th>
<th id="wording" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">wording</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="var">s1</td>
<td class="gt_row gt_left" headers="wording">To what extent could you turn to this person for advice about problems?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">s2</td>
<td class="gt_row gt_left" headers="wording">To what extent could you count on this person for help with a problem?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">s3</td>
<td class="gt_row gt_left" headers="wording">To what extent can you really count on this person to distract you from your worries when you feel under stress?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">s4</td>
<td class="gt_row gt_left" headers="wording">To what extent can you count on this person to listen to you when you are very angry at someone else?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">c1</td>
<td class="gt_row gt_left" headers="wording">How often do you have to work hard to avoid conflict with this person?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var" style="background-color: #F9E3D6; font-style: italic">c2</td>
<td class="gt_row gt_left" headers="wording" style="background-color: #F9E3D6; font-style: italic">How much do you argue with this person?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">c3</td>
<td class="gt_row gt_left" headers="wording">How much would you like this person to change?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var" style="background-color: #F9E3D6; font-style: italic">c4</td>
<td class="gt_row gt_left" headers="wording" style="background-color: #F9E3D6; font-style: italic">How often does this person make you feel angry?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">d1</td>
<td class="gt_row gt_left" headers="wording">How positive a role does this person play in your life?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">d2</td>
<td class="gt_row gt_left" headers="wording">How significant is this relationship in your life?</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="var">d3</td>
<td class="gt_row gt_left" headers="wording">How close will your relationship be with this person in 10 years?</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="var">d4</td>
<td class="gt_row gt_left" headers="wording">How much would you miss this person if the two of you could not see or talk with each other for a month?</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div></div>
</section>
<section id="modification-indices-2" class="slide level2">
<h2>modification indices</h2>
<p>Less contentious uses:</p>
<ul>
<li>residual covariances for items within a factor
<ul>
<li>essentially asserts that the two observed variables share some of their specific variance</li>
</ul></li>
</ul>
<p>More contentious uses:</p>
<ul>
<li><p>adding cross-loadings (could argue that an item loading on two factors is not a clean indicator, and so should be removed)</p></li>
<li><p>residual covariances for items on different factors - harder to defend</p></li>
<li><p>changing paths between the latent variables - very definitely changing your theory!</p></li>
</ul>
</section>
<section id="model-modification-is-exploratory" class="slide level2">
<h2>⚠ model modification is exploratory! ⚠</h2>
<p>re-specifying a model is no longer confirmatory</p>
<p>it is exploratory again!</p>
<p>gaahhhh</p>
</section></section>
<section>
<section id="interpretation" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>interpretation</h1>

</section>
<section id="cfa-interpretation" class="slide level2">
<h2>CFA interpretation</h2>
<p>there are so many parts to these models that often the “interpretation” such as it is, will boil down to:</p>
<ol type="1">
<li>does it fit well? (and did you have to specify additional paths?)</li>
<li>are the standardised factor loadings big enough? (e.g., <span class="math inline">\(&gt;|.3|\)</span>)</li>
</ol>
<p>And then the bit we might be more interested in, things like:</p>
<ul>
<li>does F1 correlate with F2?</li>
</ul>
</section>
<section id="that-seemed-like-a-lot-of-work" class="slide level2">
<h2>that seemed like a lot of work</h2>
<p>All of this, just to test if a theoretical model of a measurement tool is replicated in your sample?</p>
</section></section>
<section>
<section id="cfa-is-a-gateway" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>CFA is a gateway…</h1>

</section>
<section id="beyond-this-point" class="slide level2">
<h2>beyond this point</h2>
<p>stuff beyond here definitely won’t be in the exam or in the quiz.</p>

<img data-src="img_sandbox/monsters.jpg" class="r-stretch"></section>
<section id="graphical-models" class="slide level2">
<h2>graphical models</h2>
<ul>
<li><p>there’s a formal logic to diagrams (“do-calculus”).</p></li>
<li><p>mainly for back-of-envelope thinking</p></li>
<li><p>essentially a way of helping to figure out how to get at an unbiased estimate of the thing we are interested in.</p></li>
<li><p>helps with thinking about any part of a study that is observed not manipulated/randomly allocated</p></li>
<li><p>I surreptitiously introduced you to this way of thinking in back in Week 1!</p></li>
</ul>

<img data-src="img_sandbox/dags.png" class="r-stretch"></section>
<section id="structural-equation-models-sem" class="slide level2">
<h2>Structural Equation Models (SEM)</h2>
<h3 id="essentially-just-diagrams-where-the-paths-are-linear-associations">(essentially just diagrams where the paths are linear associations)</h3>
<ul>
<li><p>there’s a formal algebra to the linear paths</p></li>
<li><p>this “covariance algebra” tells us what the model implied covariances are</p>
<ul>
<li>we can also do it by tracing along paths in the diagram!</li>
</ul></li>
</ul>
<p><strong>Uses:</strong></p>
<ol type="1">
<li>Testing theories beyond just those about measurement. Essentially, draw lines between variables and ask “how well does this reproduce the cov matrix?”.</li>
<li>Estimating paths between constructs while explicitly modelling measurement error</li>
</ol>
</section>
<section id="error-error-everywhere" class="slide level2">
<h2>error error everywhere</h2>
</section>
<section id="sem" class="slide level2">
<h2>SEM</h2>
<p>There’s error everywhere!<br>
Models can have structural parts and measurement parts. It all gets estimated at once!</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/semexamples/Slide3.png"></p>
</div><div class="column" style="font-size:1.2em">
<pre><code># measurement model
Y =~ y1 + y2 + y3 + ...
X =~ x1 + x2 + x3 + ...
# regressions
Y ~ X + Z
# covariances
X ~~ Z</code></pre>
</div></div>
</section>
<section id="common-uses-of-sem" class="slide level2">
<h2>common uses of SEM</h2>
<p><strong>“Nomological Net”</strong><br>
Do things correlate with other things we expect them to correlate with?<br>
<em>Good for assessing if our measure is measuring the thing we want it to measure!</em></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/semexamples/Slide1.png"></p>
</div><div class="column" style="font-size:1.2em">
<p><br></p>
<pre><code># measurement model
F1 =~ y1 + y2 + y3 + ...
F2 =~ x1 + x2 + x3 + ...
F3 =~ w1 + w2 + w3 + ...
# latent variable covariances
F1 ~~ F2
F1 ~~ F3
F2 ~~ F3</code></pre>
</div></div>
</section>
<section id="common-uses-of-sem-1" class="slide level2">
<h2>common uses of SEM</h2>
<p><strong>Measurement Invariance</strong><br>
Do factor loadings differ between groups/timepoints/contexts?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/semexamples/Slide2.png"></p>
</div><div class="column" style="font-size:1.2em">
<p><br></p>
<pre><code>F1 =~ y1 + y2 + y3 + ...</code></pre>
<p><br></p>
<pre><code>m1 &lt;- cfa(model, data, group = "mygroups")
m2 &lt;- cfa(model, data, group = "mygroups", 
                 group.equal = "loadings")  
  
semTools::compareFit(m1,m2)</code></pre>
</div></div>
</section>
<section id="common-uses-of-sem-2" class="slide level2">
<h2>common uses of SEM</h2>
<p><strong>Mediation</strong><br>
How much of X -&gt; Y is because of X -&gt; M and M -&gt; Y?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/semexamples/Slide4.png"></p>
</div><div class="column" style="font-size:1.2em">
<p><br></p>
<pre><code>Y ~ a*M + c*X
M ~ b*X
indirect := a*b
direct := c</code></pre>
<pre><code>sem(model, data)</code></pre>
<div class="myblock" style="text-align:left;font-size:.8em">
<p><strong>⚠</strong> mediation is almost always <strong>incredibly</strong> problematic. Many people dismiss it altogether as essentially useless because confounding is <em>everywhere</em>.</p>
<p>cross-sectional observational mediation = “three correlations in a trenchcoat”<sup>1</sup></p>
</div>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn7"><p>See Julia Rohrer’s great blog post: https://www.the100.ci/2025/03/20/reviewer-notes-thats-a-very-nice-mediation-analysis-you-have-there-it-would-be-a-shame-if-something-happened-to-it/ </p></li></ol></aside></section>
<section id="common-uses-of-sem-3" class="slide level2">
<h2>common uses of SEM</h2>
<p><strong>Latent Growth Curves</strong><br>
The same as <code>lmer(Y ~ TimePoint + (1 + TimePoint | Person))</code></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img_sandbox/semexamples/Slide5.png"></p>
</div><div class="column" style="font-size:1.2em">
<p><br></p>
<pre><code>int =~ 1*Time1 + 1*Time2 + 1*Time3 + ...
slope =~ 0*Time1 + 1*Time2 + 2*Time3 + ...
int ~~ slope</code></pre>
<pre><code>growth(model, data)</code></pre>
<p><img data-src="img_sandbox/lvranef.gif"></p>
</div></div>
</section>
<section id="this-week-1" class="slide level2">
<h2>This week</h2>
<p><strong>Take a look at the readings!!!</strong></p>
<p><strong>Attend the lab!!!</strong></p>
<p><strong>Come to office hours!!</strong></p>

</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="09cfa_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="09cfa_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/reveal-attribution/attribution.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="09cfa_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="09cfa_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1500,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealAttribution, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <style>

      .hide {

        display: none !important;

      }

    </style>

    

    

    <script>

      function remove() {

        let footer = document.querySelector('div.footer');

        let slideNo = document.querySelector('div.slide-number');

        slideNo.classList.add('hide');

        footer.classList.add('hide');

      

        Reveal.on('slidechanged', event => {  

          if(Reveal.isFirstSlide()) {

            slideNo.classList.add('hide');

            footer.classList.add('hide');

          } else {

            slideNo.classList.remove('hide');

            footer.classList.remove('hide');

          }

        });

      }

      

      window.onload = remove();

    </script>

    <iframe id="overlayIframe" class="overlay-iframe" title="Overlay content"></iframe>

    <!-- Close button for overlay -->

    <button id="overlayClose" class="overlay-close" title="Close overlay"></button>

    <script>

      // Grab elements

      const overlayIframe = document.getElementById('overlayIframe');

      const overlayClose  = document.getElementById('overlayClose');

    

      // Show overlay

      function showOverlay(src) {

        overlayIframe.src = src;

        overlayIframe.classList.add('visible');

        overlayClose.classList.add('visible');

      }

    

      // Hide overlay

      function hideOverlay() {

        overlayIframe.classList.remove('visible');

        overlayClose.classList.remove('visible');

        setTimeout(() => {

          if (!overlayIframe.classList.contains('visible')) {

            overlayIframe.src = 'about:blank';

          }

        }, 300);

      }

    

      // Trigger overlay on click

      document.addEventListener('click', function (e) {

        if (e.target.classList.contains('iframe-trigger')) {

          const src = e.target.getAttribute('data-src');

          if (src) showOverlay(src);

        }

      });

    

      // Close button

      overlayClose.addEventListener('click', hideOverlay);

    

      // Key handling

      document.addEventListener('keydown', function (e) {

        if (overlayIframe.classList.contains('visible')) {

          if (e.key === 'Escape') {

            // Only intercept ESC when overlay is open

            e.preventDefault();

            hideOverlay();

          } else if (["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)) {

            // Block navigation keys *only* while overlay is visible

            e.preventDefault();

          }

          // Do NOT stopPropagation — let Reveal update UI (slide numbers etc.)

        }

      });

    </script>

    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>